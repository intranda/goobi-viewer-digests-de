---
description: Goobi viewer Digest f√ºr den Juni 2020
---

# Juni

## Coming soon üöÄ 

* Erweiterung der Crowdsourcing **Kampagnen**
* Anpassungen an den **IIIF** Schnittstellen
* Datens√§tze ohne Bilder auf den **Merklisten**

## Entwicklungen

### Backend

Vor eineinhalb Jahren haben wir ein neues Designs f√ºr das Admin Backend eingef√ºhrt. Unser Ziel war es ein √ºber alle Installationen hinweg einheitliches Design zu schaffen um Dokumentation inklusive Screenshots schreiben zu k√∂nnen. Kurze Zeit sp√§ter mussten wir aber feststellen, dass es mit dem einheitlichen Design nicht getan ist. Bevor wir mit dem Dokumentieren beginnen k√∂nnen, m√ºssen auch die einzelnen Seiten √ºberarbeitet werden um Elemente einheitlich zu positionieren, zu benennen oder die Bedienung dort anzupassen, wo sie nicht intuitiv ist.

Mit der in diesem Monat ver√∂ffentlichten Version gehen wir jetzt den n√§chsten Schritt denn wir haben in den vergangenen Monaten viele Seiten general√ºberholt. Dabei wurde ein besonderes Augenmerk auf die Bedienbarkeit gelegt.

Das Bedienkonzept sieht vor, dass Informationen klar gegliedert sind und sich auf den verschiedenen Seiten immer an der gleichen Stelle wieder finden lassen. So sind zum Beispiel die Buttons zum Hinzuf√ºgen von neuen Inhalten immer oben rechts neben der Seiten√ºberschrift. Links zu Anzeigen, Bearbeiten oder L√∂schen werden erst angezeigt wenn mit der Maus √ºber den Bereich gefahren wird. Die Links werden in Tabellen einheitlich in der ersten Spalte oder alternativ innerhalb der Boxen angezeigt. F√ºr alle Formularelemente steht eine Inline-Hilfe zur Verf√ºgung die bei Bedarf eingeblendet werden kann. Ja/Nein Fragen werden nicht mehr √ºber eine Checkbox, sondern √ºber einen Schalter visualisiert.

Au√üerdem wurde ein neues URL-Konzept umgesetzt. Die Adressen der einzelnen Seiten sind nun wie im Frontend auch "stateless". Das bedeutet, dass eine URL aus der Adresszeile kopiert und weitergegeben werden kann. Die Umstellung entsch√§rft auch in der Vergangenheit aufgetretene Probleme, wenn mir dem Zur√ºck-Button des Browsers oder mit mehreren gleichzeitig ge√∂ffneten Tabs gearbeitet wurde.

{% hint style="success" %}
Alle √ºberarbeiteten Seiten erf√ºllen jetzt den **WCAG 2.1** Standard.
{% endhint %}

Die Anpassungen und Neuerungen der einzelnen Seiten sind in den folgenden Abschnitten beschrieben.

### Administration

#### Dashboard

Wird der Administrationsbereich betreten so begr√º√üt einen jetzt nicht mehr eine leere Seite, sondern ein gef√ºlltes Dashboard. Angezeigt werden neben einer Begr√º√üung die zuletzt bearbeiteten CMS-Seiten und die Versionen der installierten Goobi viewer Komponenten. Wenn Piwik / Matomo aktiviert ist kann von dem Dashboard direkt zu dem Matomo Backend gewechselt werden.

Liegen unkonfigurierte Zugriffslizenzen vor wird darauf hingewiesen. Auch die zuletzt exportierten Werke sind vertreten, da die Anzeige f√ºr einen Administratoren anders sein kann als f√ºr nicht angemeldete Benutzer.

![Auf dem neuen Dashboard stehen verschiedene Informationen zur Verf&#xFC;gung](../.gitbook/assets/2020-06_dashboard.png)

#### Benutzer

Die Tabelle mit den Benutzern zeigt nun das vom Benutzer gew√§hlte Profilbild. Au√üerdem ist sichtbar ob ein Benutzer Mitglied einer Gruppe ist oder Administratorenrechte besitzt. Dabei folgen die Farben der Badges dem folgenden Schema:

* Schwarz: Der Nutzer ist Mitglied in der angegebenen Gruppen
* Hellblau : Der Nutzer ist Eigent√ºmer der Gruppe
* Rot: Der Nutzer hat Administratorenrechte

Wird ein Benutzer bearbeitet gibt es den neuen Abschnitt "Account l√∂schen". Hier kann ein Administrator einen Account l√∂schen und dabei ausw√§hlen, ob potentiell vom Benutzer erstellte Kommentare, Crowdsourcing Inhalte und Annotationen anonymisiert, oder komplett entfernt werden sollen. Ausgenommen sind OCR Korrekturen. Bei der Anonymisierung werden die Daten der Sammel E-Mailadresse `anonymous@goobi.io` zugewiesen. Wenn eine andere Adresse gew√ºnscht wird, kann diese in der lokalen Konfigurationsdatei gesetzt werden. Siehe dazu auch [Kapitel 2.5.3](https://docs.goobi.io/goobi-viewer-de/2/2.5/2.5.3) in der Dokumentation.

![Profilbild, Gruppenzugeh&#xF6;rigkeit oder Administratoren sind in der Benutzer&#xFC;bersicht direkt erkennbar](../.gitbook/assets/2020-06_users_overview.png)

![Benutzer k&#xF6;nnen gel&#xF6;scht und Daten optional anonymisiert werden](../.gitbook/assets/2020-06_user_delete.png)

#### Gruppen und IP-Bereiche

Benutzergruppen werden jetzt als Kacheln dargestellt. War fr√ºher nur der Name und der Eigent√ºmer sichtbar, so wird nun auch die Beschreibung direkt mit angezeigt. Neu ist weiter die Angabe, wie viele Mitglieder eine Gruppe hat.

IP-Bereiche werden analog zu den Gruppen als Kacheln dargestellt.

![Gruppen werden nun als Kacheln dargestellt](../.gitbook/assets/2020-06_groups%20%281%29.png)

#### Zugriffslizenzen

Der Bereich "Lizenzen" wurde in "Zugriffslizenzen" umbenannt, um durch eine Sch√§rfung des Begriffes mehr Klarheit √ºber die Funktionalit√§t zu geben. Die Einstellungen in den Zugriffslizenzen steuern den **Zugriff auf Datens√§tze f√ºr nicht angemeldete Benutzer**.

Neben der Umbenennung gab es aber noch weitreichende andere Ver√§nderungen. Die wichtigste ist die Umkehr der Logik bei unkonfigurierten Werten. Bisher wurden Datens√§tze mit einer Zugriffslizenz angezeigt, bis deren Einschr√§nkung im Backend konfiguriert wurde. Ab sofort sind Datens√§tze mit einer Zugriffslizenz so lange gesperrt, bis festgelegt wurde, wie sie sich verhalten soll.

Auf nicht konfigurierte Werte wird prominent hingewiesen. Darunter sind die bereits konfigurierten in der bereits vorgestellten Kachelform aufgelistet. Fr√ºher wurden nur die zugewiesenen Funktionen aufgelistet. Ab sofort werden auch die nicht zugewiesenen angezeigt, so dass in der √úbersicht bereits erfasst werden kann was erlaubt wurde und was nicht. Neu ist auch die Anzeige wie viele Datens√§tze unter diese Zugriffslizenz fallen. Ein Klick auf diese Zahl f√ºhrt zu einer Suchetrefferliste, die die zugeh√∂rigen Datens√§tze auflistet.

F√ºr das Zuweisen und Entfernen von Funktionen zu einer Zugriffslizenz wurde das aus Goobi workflow bei der Verwaltung von Benutzergruppen bekannte Bedienkonzept mit farbigen Badges √ºbernommen.

![&#xDC;bersicht &#xFC;ber konfigurierte und noch zu konfigurierende Zugriffslizenzen](../.gitbook/assets/2020-06_access_licenses.png)

![Das Bedienkonzept f&#xFC;r die Zuweisung von Funktionen wurde aus Goobi workflow &#xFC;bernommen](../.gitbook/assets/2020-06_access_license_edit.png)

#### Rechte

Diese Seite ist komplett neu. Sie ersetzt die bisherigen Zuweisungsm√∂glichkeiten in den weggefallenen Reitern auf den Seiten "Benutzer", "Gruppen", "IP-Ranges" und "Lizenzen".

W√§hrend eine Zugriffslizenz nur den Zugriff f√ºr nicht angemeldete Benutzer steuert k√∂nnen hier jetzt Benutzern, Gruppen und IP-Bereichen weitergehende Funktionen einger√§umt werden. Die Auflistung der vergebenen Rechte erfolgt wieder in Kachelform. Die verwendeten Farben innerhalb der Badges folgen einem Farbkonzept, das auf der Seite selbst erkl√§rt ist.

Im folgenden zwei Beispiele f√ºr die M√∂glichkeiten der Konfiguration:

**Beispiel 1**: F√ºr eine Zugriffslizenz wurde nur die Anzeige von Metadaten konfiguriert, hier kann einem IP-Bereich auch der Zugriff auf die Bilder erlaubt werden.   
**Beispiel 2**: Ein Benutzer soll nur bestimmte Seiten im CMS bearbeiten k√∂nnen

Wenn ein neues Recht hinzugef√ºgt wird m√ºssen zuerst drei Fragen beantwortet werden:

1. Wem ein Recht zugewiesen werden soll. Zur Auswahl stehen Benutzer, Gruppen und IP-Bereiche
2. Der konkrete Eintrag. Zur Auswahl stehen die verf√ºgbaren Werte des zuvor selektierten Typs.
3. Um welche Funktionalit√§t oder welche Zugriffslizenz es sich handelt.

Sind alle drei Fragen beantwortet erscheint eine Box mit Informationen zu dem ausgew√§hlten Werten.

Sofern eine weitere Konfigurationsm√∂glichkeit existiert wird auch die Box "Funktionen" angezeigt in der die zus√§tzlichen Rechte konfiguriert werden k√∂nnen. Das kann entweder die Freischaltung weiterer Funktionen f√ºr eine Zugriffslizenz oder die Freischaltung von bestimmten Bereichen im CMS sein.

![Zus&#xE4;tzlich einger&#xE4;umte Rechte sind erstmals zentral sichtbar](../.gitbook/assets/2020-06_rights%20%281%29.png)

![Die Vergabe von Rechten wurde vereinfacht](../.gitbook/assets/2020-06_rights_edit%20%281%29.png)

### CMS

#### Seiten

Auch bei den CMS-Seiten gibt es Neuerungen. Der Link "Neue Seite anlegen" ist aus der Seitenleiste verschwunden und befindet sich nun als Hinzuf√ºgen Button oben rechts neben der Seiten√ºberschrift.

Die Tabelle mit der Auflistung der bereits existierenden CMS-Seiten wurde ebenfalls √ºberarbeitet. Neben der Neustrukturierung der Inhalte wurden zwei weitere Informationen hinzugef√ºgt: 

1. Wenn eine CMS-Seite auf eine statische Seite gemappt wurde, dann wird es mit einem orangenen Badge visualisiert
2. Wenn eine CMS-Seite einem Subtheme zugeordnet ist, wird das gew√§hlte Subtheme aufgelistet

Beim Hinzuf√ºgen einer neuen Seite ist die Liste der verf√ºgbaren CMS-Templates √ºber die Jahre stets gewachsen. Damit wurde sie auch un√ºbersichtlicher. Deswegen besteht ab sofort f√ºr Administratoren die M√∂glichkeit diese Liste zu verwalten. Daf√ºr gibt es am Ende der Seite den Link "Angezeigte Templates verwalten". Dort k√∂nnen die Templates f√ºr die Anzeige aktiviert oder deaktiviert werden k√∂nnen.

![Bei CMS Seiten wird jetzt unter anderem angezeigt, ob sie auf eine statische Seite gemappt wurden](../.gitbook/assets/2020-06_cms_pages_overview.png)

#### Kategorien

Die Kategorien werden jetzt auch als Badge visualisiert. Der lila Farbton zieht sich dabei konsequent durch alle Bereiche, in denen Kategorien verwendet werden. 

#### Statische Seiten

Bisher wurden auf der Seite "Statische Seiten" die Eintr√§ge mit √ºberschreibender CMS-Seite oben und die ohne Zuweisung darunter angezeigt. Diese Logik wurde ge√§ndert und die Eintr√§ge haben jetzt eine feste Reihenfolge. Dadurch entf√§llt das Suchen eines Eintrages in der Tabelle, da sie nun immer an der gleichen Stelle sind.

### REST API

Komplett neu ist auch die √ºberarbeitete REST API. Sie wurde im OpenAPI Standard dokumentiert und kann √ºber Swagger-UI entdeckt werden. Dort werden die einzelnen REST Endpoints auflistet und beschrieben. Diese Seite ist unter der folgenden URL zu finden:

* [https://viewer.example.org/api/swagger/](https://viewer.example.org/api/swagger/)

Ebenfalls neu ist, dass die REST API jetzt einer Versionierung unterliegt. Damit kann bei notwendigen, nicht abw√§rtskompatiblen √Ñnderungen die Versionsnummer erh√∂ht werden und Applikationen die gegen die API entwickelt wurden gehen nicht kaputt. In dem neuen Endpoint `/index/stream` kann direkt mit Solr Streaming Expressions gearbeitet werden. Weiter wurde die Testabdeckung der REST API signifikant erh√∂ht.

![Dokumentation der REST Endpoints &#xFC;ber Swagger...](../.gitbook/assets/2020-06_swagger_ui.png)

![... inklusive Schema Beschreibung](../.gitbook/assets/2020_06_swagger_scheme_description.png)

### Under the hood

Auch unter der Haube gab es auch entscheidende √Ñnderungen. Zum Einen wurde das Bootstrap Framework im Goobi viewer Core auf die Version 4 aktualisiert. Diese √Ñnderung bedeutet, dass standardm√§√üig modernere Stylinganweisungen im Browser verwendet werden.

Zum Anderen wurde der verwendete Solr Suchindex auf die Version 8 gehoben. Bisher wurde die Version 4 eingesetzt. Da Solr eine Migration √ºber mehr als zwei Major Versionen offiziell nicht unterst√ºtzt \([Hintergrund](https://issues.apache.org/jira/browse/LUCENE-9127)\) wurde der Goobi viewer Indexer erweitert, um bei der Neuindexierung des Datenbestandes in Solr 8 die notwendigen Informationen automatisch aus dem alten Index abzufragen und in den neuen mit zu √ºbernehmen.

Siehe dazu auch die [Core Changelog f√ºr die Version 4.8.0](https://docs.goobi.io/goobi-viewer-de/8/8.1#4-8-0).

### Sonstiges

* F√ºr das St√∂bern wurde ein neuer Konfigurationsschalter eingef√ºhrt, bei dem f√ºhrende Zeichen bei der Sortierung ignoriert werden sollen. Siehe auch [Kapitel 2.19.8](https://docs.goobi.io/goobi-viewer-de/2/2.19/2.19.8) in der Dokumentation.
* Der Modus `dcList` in der Blacklist f√ºr Kollektionen wurde entfernt.

### Goobi viewer Indexer

Der Goobi viewer Indexer wurde auf die Kompatibilit√§t mit Solr 8 angepasst und um die M√∂glichkeit erweitert relevante Daten aus einem Solr Index in einen anderen zu √ºbernehmen. Siehe dazu auch [Kapitel 3.1.4](https://docs.goobi.io/goobi-viewer-de/3/3.1#3-1-4-parameter-oldsolrurl) in der Dokumentation.

### Goobi viewer Connector

Der Goobi viewer Connector wurde auf die Kompatibilit√§t mit Solr 8 angepasst.

## Versionsnummern

Die Versionen die in der `pom.xml` des Themes eingetragen werden m√ºssen um die in diesem Digest beschriebenen Funktionen zu erhalten lauten:

```markup
<dependency>
    <groupId>io.goobi.viewer</groupId>
    <artifactId>viewer-core</artifactId>
    <version>4.8.0</version>
</dependency>
<dependency>
    <groupId>io.goobi.viewer</groupId>
    <artifactId>viewer-core-config</artifactId>
    <version>4.8.1</version>
</dependency>
```

Der **Goobi viewer Indexer** hat die Versionsnummer **4.8.2**.

Der **Goobi viewer Connector** hat die Versionsnummer **4.8.2**.

Das **Goobi viewer Crowdsourcing Modul** hat die Versionsnummer **1.5.0**.



