---
description: Goobi viewer Digest f√ºr Juli 2020
---

# Juli

## Coming soon üöÄ 

* Erweiterung der Crowdsourcing **Kampagnen**
* Anpassungen an den **IIIF** Schnittstellen
* Datens√§tze ohne Bilder auf den **Merklisten**

## Ank√ºndigung

In den Monaten August und September wird das Goobi viewer Team aufgrund von Elternzeit und Jahresurlauben nur eingeschr√§nkt zur Verf√ºgung stehen.

## Entwicklungen

### Karten

Die im April und Mai vorgestellte Kartenfunktionalit√§t wurde um ein Clustering von Markern erweitert. Ab einigen hundert Punkten auf einer Karte brach die Performance ein. 

Bei dem Clustering werden nah beieinander liegende Punkte aggregiert angezeigt. Wird dann in den Kartenbereich hinein gezoomt, teilen sich die Marker automatisch auf die einzelnen Positionen auf. Durch diesen Mechanismus k√∂nnen jetzt auch mehrere tausend Punkte schnell und zuverl√§ssig dargestellt werden.

![Eine Weltkarte mit aggregierten Markerclustern](../.gitbook/assets/2020-07_cluster1.png)

![Beim hineinzoomen werden die Cluster automatisch aufgeteilt oder ganz aufgel&#xF6;st](../.gitbook/assets/2020-07_cluster2.png)

### Backend

An dem im letzten Monat vorgestellten Entwicklungen am Backend gab es kleinere √Ñnderungen die das Bild insgesamt weiter abrunden. So wurde zum Beispiel der Toggle Schalter f√ºr Ja/Nein Fragen umgedreht, um der allgemeinen Konvention zu folgen, dass Nein links und Ja rechts steht.

Wenn f√ºr eine Zugriffslizenz ein Recht konfiguriert wurde, dann wird dieser Rechtenehmer auf der Seite Zugriffslizenzen mit angezeigt.

Die Suchfunktion auf den Seiten "Benutzer" und "Seiten" wurde erweitert. Bei den Benutzern kann jetzt zus√§tzlich nach der Gruppenzugeh√∂rigkeit gesucht werden. Bei den CMS-Seiten wird neben dem Titel auch in den zugewiesenen Kategorien oder Subtheme gefiltert.

![Der Ja/Nein Schalter ist nun umgekehrt, so dass Ja immer rechts steht.](../.gitbook/assets/2020-07_no_yes_toggle_reversed.png)

![Hat eine Zugriffslizenz einen erweiterten Rechtenehmer, wird dieser zus&#xE4;tzlich angezeigt.](../.gitbook/assets/2020-07_rights_holder_at_accesslicenses_displayed.png)

### Facettierung

Bisher wurde in dem Widget f√ºr die Facettierung √ºber einen Zeitraum das Start- und Endjahr ausschlie√ülich √ºber den Slider festgelegt. Ab diesem Release k√∂nnen die Jahreszahlen alternativ √ºber die Tastatur eingegeben werden. Daf√ºr kann die Jahreszahl im Widget angeklickt und bearbeitet werden. Die Einstellungen werden mit Enter √ºbernommen.

![Die Jahreszahlen in der Facettierung &#xFC;ber die Tastatur eingegeben werden.](../.gitbook/assets/2020-07_enter_year_manually.png)

### St√∂bern

Die St√∂bern Funktionalit√§t ist sehr komplex und die Anforderungen daran sind sehr unterschiedlich. Bei einem Titelindex sollen vielleicht nur die Titel von Werken aufgelistet und dabei ein Sortierfeld bedacht werden. Bei einem Personenindex wiederum sollen auch die erfassten Werte aus Strukturelementen mit enthalten sein. Und nat√ºrlich m√ºssen eventuelle Zugriffslizenzen bedacht werden. Und das ganze soll auch bei ~75.000 Werten mit ~25.000 einzelnen Eintr√§gen \(Peter M√ºller hat 1358 Eintr√§ge, Christian Wagner nur 2\) noch schnell funktionieren. Diese Aufgabe ist sehr komplex und erfordert viel Zeit um zufriedenstellende L√∂sungen zu erarbeiten.

Mit diesem Release wurde die Performance der St√∂bern Funktionalit√§t verbessert. Der Schalter `docstructFilters` ist entfallen und wird durch `filterQuery` ersetzt. Neu ist der Schalter `alwaysApplyFilter="true"` mit dem beim Aufrufen der St√∂bern Funktionalit√§t nicht eine Liste mit allen Werten generiert, sondern automatisch auf den ersten Buchstaben oder die erste Zahl facettiert wird.

### Cookies etc.

Immer wieder werden wir gefragt ob der Goobi viewer Cookies verwendet und welche Daten darin gespeichert werden. Die Antwort darauf lautete immer, dass der Goobi viewer selbst _keine_ Cookies speichert. In einer modernen Welt gibt es aber noch viel mehr M√∂glichkeiten um Daten zu speichern und das nutzt auch der Goobi viewer. Um diese Frage jedoch gut beantworten zu k√∂nnen haben wir verschiedene Umstellungen vorgenommen.

Ab sofort k√∂nnen wir mit ruhigem Gewissen sagen: "Alle automatisch vom Goobi viewer zur Bereitstellung der Funktionalit√§t erstellten Daten werden mit Ablauf der Session wieder gel√∂scht."

Technisch gesehen gibt es einen Cookie. Der wird automatisch vom Tomcat Application Server generiert. In dem Cookie ist nur eine tempor√§re Zeichenfolge, die JSESSIONID gespeichert. Diese Session wird serverseitig beim Aufruf des Goobi viewers erzeugt und speichert Informationen wie die gew√§hlte Sprache in der Benutzeroberfl√§che oder ob sich ein Nutzer angemeldet hat. Die Session wird nach 30 Minuten Inaktivit√§t automatisch gel√∂scht. Der Goobi viewer speichert dar√ºber Hinaus weitere Daten. Dies geschieht allerdings in der Browsersession. Also auf dem Computer des Nutzers und nicht auf dem Server. Die hier gespeicherten Informationen sind zum Beispiel, welche Ansicht f√ºr die Suchtreffer gew√§hlt wurde \(Details, Liste, Thumbnails\) oder welche Zoomstufe und Position ein Bild hat, damit diese Information beim Bl√§ttern beibehalten werden kann.

An dieser Stelle hat es nun eine entscheidende √Ñnderung gegeben. Der Browser bietet n√§mlich verschiedene M√∂glichkeiten diese Informationen zu Speichern. Fr√ºher haben wir daf√ºr den sogenannten "Local Storage" verwendet. Seit einiger Zeit wird vermehrt mit dem "Session Storage" gearbeitet. Mit diesem Release wurde die Verwendung des "Local Storage" abgeschafft und alle Informationen werden ausschlie√ülich im Session Storage verwaltet. Dieser Storage wird beim Schlie√üen des Tabs oder beim Schlie√üen des Browser Fensters automatisch gel√∂scht.

### Sonstiges

* Die REST API hat einen neuen Endpoint um unabh√§ngig vom Dateinamen auf den Repr√§sentanten eines Werkes zugreifen zu k√∂nnen. Hier eine Beispiel-URL: [https://viewer.goobi.io/api/v1/records/1045513032/representative/full/!400,400/0/default.jpg](https://viewer.goobi.io/api/v1/records/1045513032/representative/full/!400,400/0/default.jpg)
* Die Anzeige des Inhaltsverzeichnis in der Seitenleiste der Vollbildanzeige ist nun separat steuerbar. Siehe dazu auch [Kapitel 2.20.2](https://docs.goobi.io/goobi-viewer-de/2/2.20/2.20.2) in der Dokumentation. 
* Der PDF-Download √ºber den ausgelagerten TaskManager wurde aktualisiert und kann nun auch die neusten Schalter zur Komprimierung und Skalierung des ContentServers verwenden. Weiter wurde ein Fehler bei der Generierung von epub Dateien behoben.
* Werden √ºber die Sammlungs√ºbersicht die in einer Sammlung enthaltenen Werke angezeigt, dann entspricht das einer internen Suche. Mit diesem Release wird das nun auch in der URL so gezeigt und der Infix `/browse/` wurde durch `/search/` ersetzt. Damit ist es nun m√∂glich individuelle Suchseiten auch bei den Sammlungen zu verwenden.
* Die Installationsanleitung wurde auf die Verwendung von Ubuntu Linux 20.04 aktualisiert.

### Goobi viewer Connector

Bei der Ausgabe von Dublin Core Datens√§tzen kann jetzt die Ausgabe des `<dc:rights />` Elements in Abh√§ngigkeit der in dem Feld `ACCESSCONDITION` indexierten Werte individuell konfiguriert werden.  Siehe dazu auch [Kapitel 4.13](https://docs.goobi.io/goobi-viewer-de/4/4.1/4.1.3) in der Dokumentation.

## Versionsnummern

Die Versionen die in der `pom.xml` des Themes eingetragen werden m√ºssen um die in diesem Digest beschriebenen Funktionen zu erhalten lauten:

```markup
<dependency>
    <groupId>io.goobi.viewer</groupId>
    <artifactId>viewer-core</artifactId>
    <version>4.9.2</version>
</dependency>
<dependency>
    <groupId>io.goobi.viewer</groupId>
    <artifactId>viewer-core-config</artifactId>
    <version>4.9.0</version>
</dependency>
```

Der **Goobi viewer Indexer** hat die Versionsnummer **4.9.0**.

Der **Goobi viewer Connector** hat die Versionsnummer **4.9.0**.

Das **Goobi viewer Crowdsourcing Modul** hat die Versionsnummer **1.5.0**.



