---
description: Goobi viewer Digest f√ºr August 2020
---

# August

## Coming soon üöÄ 

* Erweiterung der Crowdsourcing **Kampagnen**
* Anpassungen an den **IIIF** Schnittstellen
* Datens√§tze ohne Bilder auf den **Merklisten**

## Ank√ºndigung

In dem Monat September wird das Goobi viewer Team aufgrund von Elternzeit und Jahresurlauben nur eingeschr√§nkt zur Verf√ºgung stehen.

## Entwicklungen

### Erweiterte PDF-Download Zugriffsbeschr√§nkung

Schon l√§nger kann der Goobi viewer die Funktionen f√ºr den PDF-Download √ºber Zugriffsbeschr√§nkungen steuern. Bisher gab es drei M√∂glichkeiten: 

1. Den PDF-Download komplett zu unterbinden
2. Den PDF-Download zusammen mit einer Bedingung auf bestimmte Strukturelemente einzuschr√§nken
3. Nur das Herunterladen von Einzelseiten-PDF zu gestatten

Ab sofort besteht zus√§tzlich die M√∂glichkeit den PDF-Download auf einen prozentualen Anteil des Werkes zu beschr√§nken. Die genaue Zahl muss dabei in den Metadaten des Werkes hinterlegt und in dem Feld `ACCESSCONDITION_PDF_PERCENTAGE_QUOTA` indexiert sein. Damit k√∂nnen Anwendungsszenarien realisiert werden, die innerhalb einer Nutzersession den Download auf beispielsweise 10% des Werkes einschr√§nken. Wird versucht mehr herunterzuladen bekommt der Nutzer eine Fehlermeldung.

![Ein Hinweis zeigt die M&#xF6;glichkeit an den Download prozentual einzuschr&#xE4;nken](../.gitbook/assets/2020-08_pdf_limit_hint.png)

![Die Funktion kann bei Bedarf abgeschaltet werden.](../.gitbook/assets/2020_pdf_limit_enabled.png)

### Karten

Wenn f√ºr ein Werk indexierte Geokoordinaten vorliegen werden diese in der Werksansicht automatisch in einem Widget mit einer Karte in der Seitenleiste dargestellt.

![Liegen Geokoordinaten vor, werden diese auf einer Karte in der Seitenleiste dargestellt.](../.gitbook/assets/2020-08_map_in_record.png)

### Merklisten

Datens√§tze ohne Bilder k√∂nnen jetzt wieder auf Merklisten gespeichert werden. Dies war mit der Vorstellung der erweiterten Unterst√ºtzung f√ºr Datens√§tze ohne Bilder im April weggefallen. Die Funktionalit√§t stehe jetzt an der bekannten Stelle in der Suchtrefferliste zur Verf√ºgung. Zus√§tzlich wird sie f√ºr diese Werke auch auf der Metadatenseite angezeigt.

![Werke ohne Bilder k&#xF6;nnen auch auf der Metadatenseite zu einer Merkliste hinzugef&#xFC;gt werden.](../.gitbook/assets/2020-08_reading_list.png)

### Resolver

Der Goobi viewer besitzt verschiedene M√∂glichkeiten um ein Werk zu resolven. Einer der Resolver ist der sogenannte _benutzerdefinierte Resolver_. Dabei kann in der URL ein Feldname und ein Wert angegeben werden. Hat diese Kombination genau einen Treffer, wird automatisch dorthin weitergeleitet.

Der benutzerdefinierte Resolver wurde erweitert, um beliebige weitere Feldnamen und Wertekombinationen √ºbergeben zu k√∂nnen. Dadurch kann ein Ergebnis weiter eingeschr√§nkt werden. So ist es nun m√∂glich zum Beispiel auf eine genaue Zeitungsausgabe zu verlinken, auch wenn diese kein eigenst√§ndiges Werk darstellt. Zum Beispiel:

```text
https://viewer.example.org/viewer/resolver?field=PI_ANCHOR&identifier=000141932&field2=YEARMONTHDAY&value2=19630221&field3=DC&value3=newspaper
```

Siehe dazu auch [Kapitel 2.22](https://docs.goobi.io/goobi-viewer-de/2/2.22) in der Dokumentation.

### RSS-Feed und St√∂bern Widget

Die beiden Widgets f√ºr die Anzeige eines RSS-Feeds und des St√∂bern Men√ºs in der Seitenleiste sind nun √ºber einen Schalter in der Konfiguration ein- und ausstellbar. Damit sind jetzt alle Widgets aus dem Goobi viewer Core √ºber die Konfigurationsdatei steuerbar.

Siehe dazu auch [Kapitel 2.23](https://docs.goobi.io/goobi-viewer-de/2/2.23) in der Dokumentation.

### Java 11

Der Goobi viewer ist nun vollst√§ndig vorbereitet f√ºr Java 11. Die Vorbereitung und Umsetzung hat ungef√§hr ein Jahr lang gedauert. Sie sind ein gutes Beispiel f√ºr notwendige Entwicklungen und Arbeiten, die an der Oberfl√§che nicht √ºber neue Features sichtbar jedoch f√ºr ein solides Fundament notwendig sind.

In **Schritt 1** haben wir die vom Goobi viewer Core, Indexer und Connector verwendeten Abh√§ngigkeiten auf aktuelle Versionen aktualisiert. Dieses ist Voraussetzung daf√ºr um Problemen in der Laufzeitumgebung vorzubeugen \(`Unsupported major.minor version`\).

In **Schritt 2** haben die Entwickler die Entwicklungsumgebung auf Java 11 umgestellt und sichergestellt, dass weiterhin alles funktioniert und kompiliert. Hier wurden dann teilweise Abh√§ngigkeiten hinzugef√ºgt, die zwischen Java 8 und Java 11 entfernt wurden und jetzt explizit eingebunden werden m√ºssen.

In **Schritt 3** wurden in unserer Continuous integration und Buildplattform die Docker Images angepasst, so dass alle Goobi viewer Jobs mit Java 11 laufen. Dort tauchten die n√§chsten Punkte auf die angepasst werden mussten, denn die automatischen Unit und Integrationstests sowie die Frameworks die daf√ºr verwendet werden waren nicht vollst√§ndig Java 11 kompatibel.

In **Schritt 4** und damit vorerst letzten Schritt haben wir den Goobi viewer auf verschiedenen Kundensystemen in einer reinen Java 11 Laufzeitumgebung in Betrieb genommen und beobachtet. Core, Indexer und Connector laufen dort seit mehreren Monaten im stabilen Einsatz und funktionieren ohne Probleme.

Damit k√∂nnen wir ruhigen Gewissens sagen: Vorbereitet f√ºr Java 11 ‚úî

Die n√§chsten Schritte dauern nun wieder etwas. Sobald ungef√§hr zwei drittel der uns bekannten Installationen aktualisiert wurden, werden wir die Java 8 Kompatibilit√§t abk√ºndigen und von den Neuerungen in Java 11 auch in dem Quellcode Gebrauch machen k√∂nnen.

### Sonstiges

* Der Goobi viewer Indexer ist bei dem Download von in METS-Dateien referenzierten ALTO Dateien flexibler geworden.
* Die Abh√§ngigkeit von der Java Bibliothek Joda wurde entfernt und durch native Java Methoden ersetzt.
* Die Logik bei den Subthemes wurde vereinfacht. Es werden in der Konfigurationsdatei nun nur noch die Attribute `mainTheme` und `discriminatorField` ausgewertet.
* Die Apidocs sind ab sofort wieder auf Github zu finden:

{% embed url="https://intranda.github.io/goobi-viewer-core/index.html" %}

## Versionsnummern

Die Versionen die in der `pom.xml` des Themes eingetragen werden m√ºssen um die in diesem Digest beschriebenen Funktionen zu erhalten lauten:

```markup
<dependency>
    <groupId>io.goobi.viewer</groupId>
    <artifactId>viewer-core</artifactId>
    <version>4.10.0</version>
</dependency>
<dependency>
    <groupId>io.goobi.viewer</groupId>
    <artifactId>viewer-core-config</artifactId>
    <version>4.10.0</version>
</dependency>
```

Der **Goobi viewer Indexer** hat die Versionsnummer **4.10.0**.

Der **Goobi viewer Connector** hat die Versionsnummer **4.10.0**.

Das **Goobi viewer Crowdsourcing Modul** hat die Versionsnummer **1.6.0**.

